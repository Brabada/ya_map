# Карта с достопримечательностями

Данный сайт отображает карту и позволяет добавлять на неё точки с достопримечательностями.

Достопримечательности можно добавлять/удалять/редактировать в админке по адресу "http://ip-вашего-сайта/admin".

Код написан на Python 3.11 на Django 4.2 фреймворке. В качестве БД использован sqlite3.

Потыкать, посмотреть: http://brabada1.pythonanywhere.com/

## Библиотеки

1. `Django 4.2` - основной фреймворк разработки.
2. `Pillow 9.5` - работа с изображениями на фронте.
3. `django-admin-sortable2 2.1` - drag'n'drop порядка фотокарточек в админке Django.
4. `django-tinymce 3.6` - поддержка редактора текста TinyMCE для полей описания достопримечательности.
5. `environs 9.5` - для работы с файлом `.env` для считывания переменных окружения.
6. `requests 2.31` - работа с HTTP-методами

## Переменные среды

Для запуска сайта в prod режиме нужно создать файл `.env` и прописать параметры следующих полей:
- `export DEBUG=<bool>` - запуск сайта в режиме Debug. При запуске с _True_, все остальные параметры не будут действительны.
- `export SECRET_KEY=<string>` - секретный токен для запуска сайта, который нужно создать самому.
- `export ALLOWED_HOSTS=<list>`- ip с которых разрешено открывать сайт. Пример: _127.0.0.1, localhost_.
- `export SECURE_SSL_REDIRECT=<bool>` - поддержка безопасного SSL редиректа.
- `export SESSION_COOKIE_SECURE=<bool>` - поддержка защиты от сниффинга куков сессии. 
- `export CSRF_COOKIE_SECURE=<bool>` - поддержка маркировки куков, как безопасные, что гарантирует их отправку через HTTPS соединение браузером.
- `export DB_SECRET=<string>` - пароль для БД.

## Быстрый запуск

1. Установить пакеты. Django 4.2 поддерживает Python версии 3.8-3.11, но желательно устанавливать под 3.11.
```bash
$ pip install -r requirements.txt
```
2. Создать файл `.env` в корне проекта и задать в нём нужные вам параметры. Для запуска в режиме отладки не выставлять настройки.

3. Инициализировать проект
```bash
$ python manage.py migrate
```
4. Запустить сайт. (Указан пример для запуска в режиме отладки)
```bash
$ python manage.py runserver
```

## Добавление данных из JSON

Сайт поддерживает добавление данных из json-файла по указанному относительному, абсолютному пути или http/https ссылке
на json-файл.

```bash
$ python manage.py load_place http://www.site.com/file1.json "./places_json/file2.json" "C:\places_json\file3.json"
```

## Пример JSON-файла
```json
{
    "title": "Павильон «Космос» на ВДНХ",
    "imgs": [
        "https://raw.githubusercontent.com/devmanorg/where-to-go-places/master/media/e5354d61df57cbd591fa3d6f8deb17f6.jpeg",
        "https://raw.githubusercontent.com/devmanorg/where-to-go-places/master/media/f9c34c9aec0d43226a7dda518026555a.jpg"
    ],
    "description_short": "«Космос» — это павильон на современной территории выставочного комплекса ВДНХ, построенный в 1939 году. Здание было расширено и приобрело существующий ныне вид в 1954 году. Тогда здесь установили купол из стали и стекла, который стал не только главной особенностью здания, но и гениальным архитектурным решением своего времени.",
    "description_long": "<p>В СССР именно в павильоне «Космос» демонстрировали экспонаты передовых сельскохозяйственных технологий и  новейшую космическую технику. После развала Союза экспозиция была забыта, частично свёрнута и оставлена там же, под большим куполом.</p><p>В течение многих лет часть павильона функционировала как выставочное пространство, а часть по-прежнему была заброшена. На среднем ярусе купола можно было обнаружить разбитые стёкла, куски фанеры и производственный мусор.</p><p>В 2016 году здесь начались реставрационные работы, в ходе которых были восстановлены стеклянный купол, панно из золотой смальты, внешний вид постройки, а также воссоздана уникальная утраченная в 1970-х годах люстра из рубинового стекла.</p><p>Сегодня в павильоне располагается выставочный центр «Космонавтика и авиация», а одним из его самых крупных экспонатов является макет модуля «Кристалл» орбитальной станции «Мир», который весит более 30 тонн.</p><p>Масштабная экспозиция состоит из трёх разделов, которые представляют как макеты, так и реальные космические аппараты, научные исследование в космической сфере, а также рассказывают о современном изучении космоса и прогнозах футуристов. Здесь также есть игровые симуляторы и 5D-кинотеатр.</p>",
    "coordinates": {
        "lng": "37.63759871907796",
        "lat": "55.82626129636804"
    }
}
```

## Запуск на проде

Для запуска на проде помимо настроек указанных в "Переменные среды" нужно собрать статику из папки assets в папку static
следующей командой:

```bash
$ python manage.py collectstatic
```